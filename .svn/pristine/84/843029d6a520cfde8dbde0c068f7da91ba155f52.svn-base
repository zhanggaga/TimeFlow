<html>
    <head>
        <title>EMAGE</title>
        <meta charset="utf8" />
        <link rel="stylesheet" type="text/css" href="style/base.css">
        <link rel="stylesheet" type="text/css" href="style/app.css">
        <!--<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>-->
        <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
        <script type="text/javascript" src="lib.js"></script>
        <script type="text/javascript">  
            require(["app"], function(app){
                app.start();
            });
            function saveAsLocalImage () {  
                var myCanvas = document.getElementsByTagName("canvas").item(0);
                // here is the most important part because if you dont replace you will get a DOM 18 exception.  
                // var image = myCanvas.toDataURL("image/png").replace("image/png", "image/octet-stream;Content-Disposition: attachment;filename=foobar.png");  
                var image = myCanvas.toDataURL("image/png").replace("image/png", "image/octet-stream");   
                window.location.href=image; // it will save locally  
            } 
            function tredt() {
            var myCanvas = document.getElementsByTagName("canvas").item(2);
//          var canvasItem = $(".div.qpf-ui-vbox canvas");
//          var canvasItem = document.getElementsByTagName("canvas");
//          alert(canvasItem.length);
//          alert(canvasItem[0]);
            var image = myCanvas.toDataURL("image/png");//.replace("image/png", "image/octet-stream"); 
            window.location.href=image; // it will save locally     
            }
        </script>
        <script type="text/javascript">


        </script>
    </head>
    <body id="Gallery">
        <button id="saveImage" onclick="tredt()">Save</button>

        <script type="text/javscript">
        document.getElementById("saveImage).click = function() {
        alert();
            var myCanvas = document.getElementsByTagName("canvas").item(0);
            var image = myCanvas.toDataURL("image/png").replace("image/png", "image/octet-stream"); 
            window.location.href=image; // it will save locally            
        }

        </script>
    </body>
</html>